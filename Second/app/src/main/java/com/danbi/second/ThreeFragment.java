package com.danbi.second;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothSocket;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.support.v4.app.Fragment;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

import com.google.gson.Gson;

import org.json.JSONArray;
import org.json.JSONException;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.Set;
import java.util.UUID;

import retrofit2.Call;
import retrofit2.Callback;
import retrofit2.Response;

import static android.app.Activity.RESULT_OK;

public class ThreeFragment extends Fragment {
    @Nullable
    private static final int REQUEST_ENABLE_BT = 10; // 블루투스 활성화 상태
    private BluetoothAdapter bluetoothAdapter; // 블루투스 어댑터
    private Set<BluetoothDevice> devices; // 블루투스 디바이스 데이터 셋
    private BluetoothDevice bluetoothDevice; // 블루투스 디바이스
    private OutputStream outputStream = null; // 블루투스에 데이터를 출력하기 위한 출력 스트림
    private InputStream inputStream = null; // 블루투스에 데이터를 입력하기 위한 입력 스트림
    private byte[] readBuffer; // 수신 된 문자열을 저장하기 위한 버퍼
    private int readBufferPosition; // 버퍼 내 문자 저장 위치
    private TextView textViewReceive; // 수신 된 데이터를 표시하기 위한 텍스트 뷰
    private EditText editTextSend; // 송신 할 데이터를 작성하기 위한 에딧 텍스트
    private Button buttonSend; // 송신하기 위한 버튼
    JSONArray jsonArray = new JSONArray();
    List<Map> ListMapF = new ArrayList<>();
    int pairedDeviceCount;
    TextView dataInfo;

    @SuppressLint("SetTextI18n")
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_three, container, false);
        dataInfo = view.findViewById(R.id.dataInfo);
        ListMapF = ((MainActivity) Objects.requireNonNull(getActivity())).ListMap;
        if (ListMapF.size() != 0) {
            int j, maxIndex = 0;
            for (int i = 0; i < ListMapF.size() - 1; ) {
                String data = ListMapF.get(i).get("DataTime").toString().substring(0, 11);
                for (j = i; j < ListMapF.size() && data.equals(ListMapF.get(j).get("DataTime").toString().substring(0, 11)); j++) {
                }
                maxIndex++;
                Log.d("index", maxIndex + " : " + data);
                i = j;
            }
            dataInfo.setText("서버로부터 " + maxIndex + "일 간의 총 " + ListMapF.size() + "개의 데이터를 불러왔습니다.");
        }
        else{
            dataInfo.setText("데이터가 없습니다.");
        }
        Button serverButton = view.findViewById(R.id.serverButton);
        final MainActivity activity = (MainActivity) getActivity();
        serverButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Call<String> res = NetRetrofit.getInstance().getService().getJson();
                res.enqueue(new Callback<String>() {
                    @SuppressLint("SetTextI18n")
                    @Override
                    public void onResponse(Call<String> call, Response<String> response) {
                        final Toast toast = Toast.makeText(activity, "서버와의 통신에 성공했습니다.", Toast.LENGTH_LONG);
                        toast.show();
                        String dataInput = "";
                        dataInput = response.body();
                        Log.d("parsed", dataInput);
                        if (dataInput == null) {
                            dataInput = "[{'Number_of_samples': 1990, 'pm1_0': 21, 'methanen': 229, 'Co': 8, 'gas': 133, 'DataTime': '2019-05-11 04:43:03.252919', 'Humid': 36, 'Temp': 24, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 1992, 'pm1_0': 20, 'methanen': 248, 'Co': 8, 'gas': 140, 'DataTime': '2019-05-11 05:14:10.398336', 'Humid': 36, 'Temp': 24, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 1993, 'pm1_0': 19, 'methanen': 249, 'Co': 8, 'gas': 140, 'DataTime': '2019-05-11 05:44:10.515029', 'Humid': 35, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1994, 'pm1_0': 19, 'methanen': 246, 'Co': 8, 'gas': 141, 'DataTime': '2019-05-11 06:14:10.710924', 'Humid': 35, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1995, 'pm1_0': 19, 'methanen': 247, 'Co': 8, 'gas': 141, 'DataTime': '2019-05-11 06:44:10.929209', 'Humid': 36, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1996, 'pm1_0': 19, 'methanen': 246, 'Co': 8, 'gas': 141, 'DataTime': '2019-05-11 07:14:11.066826', 'Humid': 35, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1997, 'pm1_0': 19, 'methanen': 248, 'Co': 8, 'gas': 142, 'DataTime': '2019-05-11 07:44:11.253612', 'Humid': 36, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1998, 'pm1_0': 19, 'methanen': 245, 'Co': 7, 'gas': 141, 'DataTime': '2019-05-11 08:14:11.467590', 'Humid': 36, 'Temp': 24, 'pm10': 23, 'GAS_leak': 'false'}, {'Number_of_samples': 1999, 'pm1_0': 20, 'methanen': 246, 'Co': 8, 'gas': 141, 'DataTime': '2019-05-11 08:44:11.683785', 'Humid': 36, 'Temp': 24, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2000, 'pm1_0': 20, 'methanen': 245, 'Co': 8, 'gas': 141, 'DataTime': '2019-05-11 09:14:11.815466', 'Humid': 36, 'Temp': 24, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2001, 'pm1_0': 19, 'methanen': 248, 'Co': 8, 'gas': 142, 'DataTime': '2019-05-11 09:44:12.030567', 'Humid': 36, 'Temp': 24, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2002, 'pm1_0': 25, 'methanen': 425, 'Co': 12, 'gas': 203, 'DataTime': '2019-05-11 10:07:35.141870', 'Humid': 41, 'Temp': 27, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2003, 'pm1_0': 26, 'methanen': 430, 'Co': 12, 'gas': 201, 'DataTime': '2019-05-11 10:37:35.251377', 'Humid': 40, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2004, 'pm1_0': 27, 'methanen': 427, 'Co': 12, 'gas': 200, 'DataTime': '2019-05-11 11:07:35.465385', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2005, 'pm1_0': 27, 'methanen': 425, 'Co': 12, 'gas': 201, 'DataTime': '2019-05-11 11:37:35.673246', 'Humid': 39, 'Temp': 24, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2006, 'pm1_0': 27, 'methanen': 421, 'Co': 12, 'gas': 203, 'DataTime': '2019-05-11 12:07:35.806826', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2007, 'pm1_0': 26, 'methanen': 422, 'Co': 12, 'gas': 201, 'DataTime': '2019-05-11 12:37:35.932391', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2008, 'pm1_0': 26, 'methanen': 423, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-11 13:07:36.044326', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2009, 'pm1_0': 25, 'methanen': 417, 'Co': 12, 'gas': 212, 'DataTime': '2019-05-11 13:37:36.243591', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2010, 'pm1_0': 24, 'methanen': 420, 'Co': 12, 'gas': 218, 'DataTime': '2019-05-11 14:07:36.357080', 'Humid': 39, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2011, 'pm1_0': 25, 'methanen': 420, 'Co': 12, 'gas': 213, 'DataTime': '2019-05-11 14:37:36.543887', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2012, 'pm1_0': 26, 'methanen': 421, 'Co': 12, 'gas': 212, 'DataTime': '2019-05-11 15:07:36.752379', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2013, 'pm1_0': 26, 'methanen': 418, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 15:37:36.952065', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2014, 'pm1_0': 25, 'methanen': 417, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-11 16:07:37.159115', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2015, 'pm1_0': 26, 'methanen': 419, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 16:37:37.367025', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2016, 'pm1_0': 26, 'methanen': 417, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-11 17:07:37.577457', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2017, 'pm1_0': 27, 'methanen': 414, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-11 17:37:37.706316', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2018, 'pm1_0': 27, 'methanen': 417, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-11 18:07:37.925357', 'Humid': 39, 'Temp': 24, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2019, 'pm1_0': 27, 'methanen': 415, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-11 18:37:38.128407', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2020, 'pm1_0': 26, 'methanen': 416, 'Co': 12, 'gas': 207, 'DataTime': '2019-05-11 19:07:38.246562', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2021, 'pm1_0': 25, 'methanen': 415, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-11 19:37:38.450019', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2022, 'pm1_0': 26, 'methanen': 416, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-11 20:07:38.627623', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2023, 'pm1_0': 25, 'methanen': 415, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-11 20:37:38.771934', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2024, 'pm1_0': 25, 'methanen': 417, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 21:07:38.925015', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2025, 'pm1_0': 25, 'methanen': 412, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 21:37:39.044897', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2026, 'pm1_0': 26, 'methanen': 416, 'Co': 12, 'gas': 208, 'DataTime': '2019-05-11 22:07:39.251280', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2027, 'pm1_0': 26, 'methanen': 416, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-11 22:37:39.367484', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2028, 'pm1_0': 26, 'methanen': 421, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 23:07:39.595264', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2029, 'pm1_0': 26, 'methanen': 414, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-11 23:37:39.861115', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2030, 'pm1_0': 26, 'methanen': 417, 'Co': 12, 'gas': 212, 'DataTime': '2019-05-12 00:07:40.070577', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2031, 'pm1_0': 26, 'methanen': 416, 'Co': 12, 'gas': 213, 'DataTime': '2019-05-12 00:37:40.268459', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2032, 'pm1_0': 28, 'methanen': 416, 'Co': 12, 'gas': 214, 'DataTime': '2019-05-12 01:07:40.469843', 'Humid': 39, 'Temp': 24, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2033, 'pm1_0': 27, 'methanen': 417, 'Co': 12, 'gas': 213, 'DataTime': '2019-05-12 01:37:40.629961', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2034, 'pm1_0': 26, 'methanen': 423, 'Co': 12, 'gas': 212, 'DataTime': '2019-05-12 02:07:40.834080', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2035, 'pm1_0': 25, 'methanen': 416, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-12 02:37:41.043656', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2036, 'pm1_0': 26, 'methanen': 415, 'Co': 12, 'gas': 208, 'DataTime': '2019-05-12 03:07:41.246820', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2037, 'pm1_0': 27, 'methanen': 414, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-12 03:37:41.458244', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2038, 'pm1_0': 25, 'methanen': 417, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-12 04:07:41.644529', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2039, 'pm1_0': 25, 'methanen': 418, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-12 04:37:41.769731', 'Humid': 39, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2040, 'pm1_0': 25, 'methanen': 416, 'Co': 12, 'gas': 211, 'DataTime': '2019-05-12 05:07:41.890986', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2041, 'pm1_0': 26, 'methanen': 418, 'Co': 12, 'gas': 210, 'DataTime': '2019-05-12 05:37:42.042196', 'Humid': 39, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2042, 'pm1_0': 25, 'methanen': 416, 'Co': 12, 'gas': 200, 'DataTime': '2019-05-12 06:07:42.256546', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2043, 'pm1_0': 26, 'methanen': 417, 'Co': 12, 'gas': 207, 'DataTime': '2019-05-12 06:37:42.446654', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2044, 'pm1_0': 26, 'methanen': 417, 'Co': 12, 'gas': 201, 'DataTime': '2019-05-12 07:07:42.647449', 'Humid': 39, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2045, 'pm1_0': 26, 'methanen': 419, 'Co': 12, 'gas': 206, 'DataTime': '2019-05-12 07:37:42.843304', 'Humid': 38, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2046, 'pm1_0': 29, 'methanen': 267, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 12:06:04.790152', 'Humid': 41, 'Temp': 24, 'pm10': 36, 'GAS_leak': 'false'}, {'Number_of_samples': 2047, 'pm1_0': 33, 'methanen': 267, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 12:36:05.001692', 'Humid': 35, 'Temp': 24, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2048, 'pm1_0': 32, 'methanen': 266, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 13:06:05.210679', 'Humid': 35, 'Temp': 24, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2049, 'pm1_0': 33, 'methanen': 267, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 13:36:05.381579', 'Humid': 35, 'Temp': 24, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2050, 'pm1_0': 32, 'methanen': 266, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 14:06:05.519006', 'Humid': 35, 'Temp': 24, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2051, 'pm1_0': 32, 'methanen': 266, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 14:36:05.729278', 'Humid': 35, 'Temp': 24, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2052, 'pm1_0': 31, 'methanen': 266, 'Co': 6, 'gas': 158, 'DataTime': '2019-05-12 15:06:05.942246', 'Humid': 35, 'Temp': 24, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2053, 'pm1_0': 31, 'methanen': 265, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 15:36:06.151174', 'Humid': 35, 'Temp': 24, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2054, 'pm1_0': 30, 'methanen': 264, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 16:06:06.273027', 'Humid': 35, 'Temp': 24, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2055, 'pm1_0': 30, 'methanen': 266, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 16:36:06.424910', 'Humid': 35, 'Temp': 24, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2056, 'pm1_0': 31, 'methanen': 290, 'Co': 6, 'gas': 172, 'DataTime': '2019-05-12 16:41:21.229382', 'Humid': 0, 'Temp': 0, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2057, 'pm1_0': 33, 'methanen': 290, 'Co': 6, 'gas': 173, 'DataTime': '2019-05-12 17:11:21.419737', 'Humid': 32, 'Temp': 26, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2058, 'pm1_0': 33, 'methanen': 289, 'Co': 6, 'gas': 174, 'DataTime': '2019-05-12 17:41:21.615621', 'Humid': 32, 'Temp': 26, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2059, 'pm1_0': 33, 'methanen': 290, 'Co': 6, 'gas': 173, 'DataTime': '2019-05-12 18:11:21.825911', 'Humid': 32, 'Temp': 26, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2060, 'pm1_0': 28, 'methanen': 322, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 19:15:55.105206', 'Humid': 0, 'Temp': 0, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2061, 'pm1_0': 31, 'methanen': 321, 'Co': 6, 'gas': 150, 'DataTime': '2019-05-12 19:45:55.467970', 'Humid': 39, 'Temp': 26, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2062, 'pm1_0': 30, 'methanen': 320, 'Co': 6, 'gas': 159, 'DataTime': '2019-05-12 20:15:55.683494', 'Humid': 39, 'Temp': 26, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2063, 'pm1_0': 30, 'methanen': 320, 'Co': 6, 'gas': 159, 'DataTime': '2019-05-12 20:45:55.811359', 'Humid': 39, 'Temp': 26, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2064, 'pm1_0': 29, 'methanen': 323, 'Co': 6, 'gas': 160, 'DataTime': '2019-05-12 21:15:55.932741', 'Humid': 40, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2065, 'pm1_0': 29, 'methanen': 324, 'Co': 6, 'gas': 165, 'DataTime': '2019-05-12 21:45:56.094705', 'Humid': 39, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2066, 'pm1_0': 28, 'methanen': 321, 'Co': 6, 'gas': 170, 'DataTime': '2019-05-12 22:15:56.295635', 'Humid': 40, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2067, 'pm1_0': 29, 'methanen': 321, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-12 22:45:56.458372', 'Humid': 39, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2068, 'pm1_0': 28, 'methanen': 320, 'Co': 6, 'gas': 160, 'DataTime': '2019-05-12 23:15:56.663958', 'Humid': 40, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2069, 'pm1_0': 28, 'methanen': 320, 'Co': 6, 'gas': 165, 'DataTime': '2019-05-12 23:45:56.826260', 'Humid': 40, 'Temp': 26, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2070, 'pm1_0': 29, 'methanen': 320, 'Co': 6, 'gas': 160, 'DataTime': '2019-05-13 00:15:56.967761', 'Humid': 40, 'Temp': 26, 'pm10': 36, 'GAS_leak': 'false'}, {'Number_of_samples': 2071, 'pm1_0': 30, 'methanen': 320, 'Co': 6, 'gas': 163, 'DataTime': '2019-05-13 00:45:57.098107', 'Humid': 40, 'Temp': 26, 'pm10': 36, 'GAS_leak': 'false'}, {'Number_of_samples': 2072, 'pm1_0': 31, 'methanen': 320, 'Co': 6, 'gas': 166, 'DataTime': '2019-05-13 01:15:57.283702', 'Humid': 40, 'Temp': 26, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2073, 'pm1_0': 31, 'methanen': 324, 'Co': 6, 'gas': 170, 'DataTime': '2019-05-13 01:45:57.439130', 'Humid': 40, 'Temp': 26, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2074, 'pm1_0': 30, 'methanen': 306, 'Co': 11, 'gas': 211, 'DataTime': '2019-05-13 02:52:20.833098', 'Humid': 0, 'Temp': 0, 'pm10': 36, 'GAS_leak': 'false'}, {'Number_of_samples': 2075, 'pm1_0': 28, 'methanen': 311, 'Co': 11, 'gas': 206, 'DataTime': '2019-05-13 03:22:21.032909', 'Humid': 39, 'Temp': 22, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2076, 'pm1_0': 29, 'methanen': 312, 'Co': 11, 'gas': 203, 'DataTime': '2019-05-13 03:52:21.234182', 'Humid': 39, 'Temp': 22, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2077, 'pm1_0': 29, 'methanen': 308, 'Co': 11, 'gas': 201, 'DataTime': '2019-05-13 04:22:21.451642', 'Humid': 39, 'Temp': 22, 'pm10': 36, 'GAS_leak': 'false'}, {'Number_of_samples': 2078, 'pm1_0': 31, 'methanen': 303, 'Co': 11, 'gas': 200, 'DataTime': '2019-05-13 04:52:21.656436', 'Humid': 39, 'Temp': 22, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2079, 'pm1_0': 31, 'methanen': 294, 'Co': 11, 'gas': 197, 'DataTime': '2019-05-13 05:22:21.780834', 'Humid': 39, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2080, 'pm1_0': 31, 'methanen': 300, 'Co': 11, 'gas': 196, 'DataTime': '2019-05-13 05:52:21.985222', 'Humid': 39, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2081, 'pm1_0': 31, 'methanen': 304, 'Co': 11, 'gas': 195, 'DataTime': '2019-05-13 06:22:22.191019', 'Humid': 39, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2082, 'pm1_0': 30, 'methanen': 308, 'Co': 11, 'gas': 194, 'DataTime': '2019-05-13 06:52:22.396252', 'Humid': 39, 'Temp': 22, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2083, 'pm1_0': 30, 'methanen': 301, 'Co': 11, 'gas': 193, 'DataTime': '2019-05-13 07:22:22.524769', 'Humid': 39, 'Temp': 22, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2084, 'pm1_0': 30, 'methanen': 299, 'Co': 11, 'gas': 193, 'DataTime': '2019-05-13 07:52:22.732811', 'Humid': 38, 'Temp': 22, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2085, 'pm1_0': 31, 'methanen': 306, 'Co': 11, 'gas': 194, 'DataTime': '2019-05-13 08:22:22.840178', 'Humid': 39, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2086, 'pm1_0': 31, 'methanen': 310, 'Co': 11, 'gas': 193, 'DataTime': '2019-05-13 08:52:22.972493', 'Humid': 38, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2087, 'pm1_0': 31, 'methanen': 304, 'Co': 11, 'gas': 193, 'DataTime': '2019-05-13 09:22:23.184049', 'Humid': 38, 'Temp': 22, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2088, 'pm1_0': 31, 'methanen': 303, 'Co': 11, 'gas': 192, 'DataTime': '2019-05-13 09:52:23.396993', 'Humid': 38, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2089, 'pm1_0': 31, 'methanen': 305, 'Co': 11, 'gas': 192, 'DataTime': '2019-05-13 10:22:23.601340', 'Humid': 38, 'Temp': 22, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2090, 'pm1_0': 31, 'methanen': 311, 'Co': 13, 'gas': 186, 'DataTime': '2019-05-13 10:52:05.304217', 'Humid': 38, 'Temp': 26, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2091, 'pm1_0': 30, 'methanen': 313, 'Co': 13, 'gas': 185, 'DataTime': '2019-05-13 11:22:05.696942', 'Humid': 41, 'Temp': 23, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2092, 'pm1_0': 22, 'methanen': 315, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 13:46:50.568870', 'Humid': 25, 'Temp': 37, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2093, 'pm1_0': 22, 'methanen': 287, 'Co': 6, 'gas': 159, 'DataTime': '2019-05-13 13:59:06.090120', 'Humid': 27, 'Temp': 39, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2094, 'pm1_0': 23, 'methanen': 275, 'Co': 6, 'gas': 152, 'DataTime': '2019-05-13 14:44:28.804503', 'Humid': 26, 'Temp': 39, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2095, 'pm1_0': 23, 'methanen': 312, 'Co': 6, 'gas': 157, 'DataTime': '2019-05-13 15:13:28.809444', 'Humid': 39, 'Temp': 30, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2096, 'pm1_0': 22, 'methanen': 323, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:30:44.451222', 'Humid': 39, 'Temp': 24, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2097, 'pm1_0': 20, 'methanen': 321, 'Co': 6, 'gas': 154, 'DataTime': '2019-05-13 15:30:55.671743', 'Humid': 41, 'Temp': 24, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2098, 'pm1_0': 21, 'methanen': 321, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:31:15.041075', 'Humid': 26, 'Temp': 40, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2099, 'pm1_0': 23, 'methanen': 326, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:31:26.321456', 'Humid': 41, 'Temp': 25, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2100, 'pm1_0': 24, 'methanen': 323, 'Co': 6, 'gas': 154, 'DataTime': '2019-05-13 15:31:37.642271', 'Humid': 41, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2101, 'pm1_0': 24, 'methanen': 325, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:31:48.891765', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2102, 'pm1_0': 24, 'methanen': 326, 'Co': 6, 'gas': 153, 'DataTime': '2019-05-13 15:32:00.182425', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2103, 'pm1_0': 24, 'methanen': 323, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 15:32:12.538769', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2104, 'pm1_0': 24, 'methanen': 324, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 15:32:22.871877', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2105, 'pm1_0': 24, 'methanen': 323, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:32:34.109852', 'Humid': 41, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2106, 'pm1_0': 24, 'methanen': 323, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:32:45.462247', 'Humid': 41, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2107, 'pm1_0': 25, 'methanen': 327, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:32:56.692358', 'Humid': 41, 'Temp': 25, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2108, 'pm1_0': 24, 'methanen': 323, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:33:08.042028', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2109, 'pm1_0': 24, 'methanen': 320, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 15:33:19.316513', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2110, 'pm1_0': 23, 'methanen': 322, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 15:33:30.612028', 'Humid': 41, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2111, 'pm1_0': 23, 'methanen': 325, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:33:41.936843', 'Humid': 41, 'Temp': 25, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2112, 'pm1_0': 23, 'methanen': 321, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:33:53.342614', 'Humid': 40, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2113, 'pm1_0': 23, 'methanen': 323, 'Co': 7, 'gas': 156, 'DataTime': '2019-05-13 15:34:04.612334', 'Humid': 41, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2114, 'pm1_0': 22, 'methanen': 325, 'Co': 6, 'gas': 155, 'DataTime': '2019-05-13 15:34:15.891693', 'Humid': 41, 'Temp': 25, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2115, 'pm1_0': 24, 'methanen': 324, 'Co': 6, 'gas': 156, 'DataTime': '2019-05-13 15:34:27.232138', 'Humid': 41, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2116, 'pm1_0': 21, 'methanen': 362, 'Co': 10, 'gas': 201, 'DataTime': '2019-05-13 15:51:25.636648', 'Humid': 41, 'Temp': 25, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2117, 'pm1_0': 23, 'methanen': 373, 'Co': 11, 'gas': 223, 'DataTime': '2019-05-13 16:39:25.782721', 'Humid': 40, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2118, 'pm1_0': 22, 'methanen': 376, 'Co': 11, 'gas': 224, 'DataTime': '2019-05-13 16:39:37.073485', 'Humid': 41, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2119, 'pm1_0': 23, 'methanen': 377, 'Co': 11, 'gas': 225, 'DataTime': '2019-05-13 16:39:48.352524', 'Humid': 42, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2120, 'pm1_0': 23, 'methanen': 378, 'Co': 11, 'gas': 224, 'DataTime': '2019-05-13 16:39:59.670741', 'Humid': 42, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2121, 'pm1_0': 24, 'methanen': 377, 'Co': 11, 'gas': 223, 'DataTime': '2019-05-13 16:40:11.023357', 'Humid': 42, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2122, 'pm1_0': 22, 'methanen': 378, 'Co': 12, 'gas': 229, 'DataTime': '2019-05-13 16:41:40.352996', 'Humid': 42, 'Temp': 24, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2123, 'pm1_0': 22, 'methanen': 377, 'Co': 12, 'gas': 230, 'DataTime': '2019-05-13 16:41:51.683942', 'Humid': 42, 'Temp': 24, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2124, 'pm1_0': 22, 'methanen': 379, 'Co': 12, 'gas': 233, 'DataTime': '2019-05-13 16:42:02.983036', 'Humid': 42, 'Temp': 25, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2125, 'pm1_0': 22, 'methanen': 374, 'Co': 11, 'gas': 223, 'DataTime': '2019-05-13 16:42:14.240857', 'Humid': 42, 'Temp': 25, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2126, 'pm1_0': 23, 'methanen': 376, 'Co': 11, 'gas': 222, 'DataTime': '2019-05-13 16:42:25.592921', 'Humid': 42, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2127, 'pm1_0': 22, 'methanen': 377, 'Co': 11, 'gas': 222, 'DataTime': '2019-05-13 16:42:36.863704', 'Humid': 41, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2128, 'pm1_0': 22, 'methanen': 376, 'Co': 10, 'gas': 220, 'DataTime': '2019-05-13 16:42:48.163960', 'Humid': 41, 'Temp': 25, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2129, 'pm1_0': 23, 'methanen': 371, 'Co': 10, 'gas': 219, 'DataTime': '2019-05-13 16:44:22.873592', 'Humid': 39, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2130, 'pm1_0': 22, 'methanen': 373, 'Co': 10, 'gas': 220, 'DataTime': '2019-05-13 16:44:34.172922', 'Humid': 41, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2131, 'pm1_0': 22, 'methanen': 374, 'Co': 10, 'gas': 220, 'DataTime': '2019-05-13 16:44:45.471944', 'Humid': 42, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2132, 'pm1_0': 24, 'methanen': 369, 'Co': 10, 'gas': 220, 'DataTime': '2019-05-13 16:45:41.971776', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2133, 'pm1_0': 24, 'methanen': 366, 'Co': 11, 'gas': 219, 'DataTime': '2019-05-13 16:46:16.143544', 'Humid': 40, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2134, 'pm1_0': 24, 'methanen': 374, 'Co': 11, 'gas': 222, 'DataTime': '2019-05-13 16:46:27.388445', 'Humid': 41, 'Temp': 25, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2135, 'pm1_0': 23, 'methanen': 379, 'Co': 10, 'gas': 223, 'DataTime': '2019-05-13 16:46:38.713870', 'Humid': 42, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2136, 'pm1_0': 22, 'methanen': 373, 'Co': 10, 'gas': 222, 'DataTime': '2019-05-13 16:46:50.103674', 'Humid': 42, 'Temp': 25, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2137, 'pm1_0': 22, 'methanen': 371, 'Co': 10, 'gas': 220, 'DataTime': '2019-05-13 16:47:00.724679', 'Humid': 41, 'Temp': 26, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2138, 'pm1_0': 20, 'methanen': 384, 'Co': 11, 'gas': 234, 'DataTime': '2019-05-13 17:17:09.378736', 'Humid': 41, 'Temp': 25, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 2139, 'pm1_0': 19, 'methanen': 377, 'Co': 10, 'gas': 238, 'DataTime': '2019-05-13 18:06:17.335531', 'Humid': 39, 'Temp': 26, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2140, 'pm1_0': 17, 'methanen': 402, 'Co': 12, 'gas': 206, 'DataTime': '2019-05-13 18:35:12.271742', 'Humid': 39, 'Temp': 25, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2141, 'pm1_0': 17, 'methanen': 401, 'Co': 12, 'gas': 206, 'DataTime': '2019-05-13 18:35:23.591917', 'Humid': 35, 'Temp': 26, 'pm10': 22, 'GAS_leak': 'false'}, {'Number_of_samples': 2142, 'pm1_0': 17, 'methanen': 392, 'Co': 13, 'gas': 234, 'DataTime': '2019-05-13 18:35:34.882010', 'Humid': 35, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2143, 'pm1_0': 17, 'methanen': 369, 'Co': 11, 'gas': 204, 'DataTime': '2019-05-13 18:35:46.203623', 'Humid': 41, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2144, 'pm1_0': 17, 'methanen': 337, 'Co': 7, 'gas': 175, 'DataTime': '2019-05-13 18:35:57.493620', 'Humid': 39, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2145, 'pm1_0': 17, 'methanen': 337, 'Co': 11, 'gas': 202, 'DataTime': '2019-05-13 18:36:08.822445', 'Humid': 36, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2146, 'pm1_0': 17, 'methanen': 347, 'Co': 11, 'gas': 202, 'DataTime': '2019-05-13 18:36:20.103565', 'Humid': 36, 'Temp': 26, 'pm10': 22, 'GAS_leak': 'false'}, {'Number_of_samples': 2147, 'pm1_0': 17, 'methanen': 348, 'Co': 11, 'gas': 199, 'DataTime': '2019-05-13 18:36:31.432804', 'Humid': 36, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2148, 'pm1_0': 17, 'methanen': 351, 'Co': 12, 'gas': 207, 'DataTime': '2019-05-13 18:36:42.702924', 'Humid': 35, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2149, 'pm1_0': 16, 'methanen': 334, 'Co': 12, 'gas': 205, 'DataTime': '2019-05-13 18:36:54.132448', 'Humid': 35, 'Temp': 26, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2150, 'pm1_0': 16, 'methanen': 346, 'Co': 13, 'gas': 214, 'DataTime': '2019-05-13 18:37:05.304704', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2151, 'pm1_0': 17, 'methanen': 360, 'Co': 12, 'gas': 207, 'DataTime': '2019-05-13 18:37:16.624162', 'Humid': 35, 'Temp': 27, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2152, 'pm1_0': 17, 'methanen': 367, 'Co': 12, 'gas': 209, 'DataTime': '2019-05-13 18:37:27.885046', 'Humid': 35, 'Temp': 26, 'pm10': 22, 'GAS_leak': 'false'}, {'Number_of_samples': 2153, 'pm1_0': 17, 'methanen': 359, 'Co': 10, 'gas': 193, 'DataTime': '2019-05-13 18:37:39.233741', 'Humid': 35, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2154, 'pm1_0': 17, 'methanen': 378, 'Co': 9, 'gas': 188, 'DataTime': '2019-05-13 18:37:50.504153', 'Humid': 37, 'Temp': 26, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2155, 'pm1_0': 16, 'methanen': 382, 'Co': 9, 'gas': 185, 'DataTime': '2019-05-13 18:38:01.774163', 'Humid': 36, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2156, 'pm1_0': 16, 'methanen': 375, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:38:13.084609', 'Humid': 36, 'Temp': 26, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2157, 'pm1_0': 16, 'methanen': 380, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:38:24.444475', 'Humid': 35, 'Temp': 26, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2158, 'pm1_0': 16, 'methanen': 368, 'Co': 9, 'gas': 182, 'DataTime': '2019-05-13 18:38:35.714794', 'Humid': 35, 'Temp': 26, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2159, 'pm1_0': 16, 'methanen': 365, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:38:47.014381', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2160, 'pm1_0': 15, 'methanen': 377, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:38:58.344565', 'Humid': 36, 'Temp': 27, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2161, 'pm1_0': 15, 'methanen': 409, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:39:09.635713', 'Humid': 35, 'Temp': 26, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2162, 'pm1_0': 16, 'methanen': 422, 'Co': 9, 'gas': 184, 'DataTime': '2019-05-13 18:39:21.022051', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2163, 'pm1_0': 16, 'methanen': 414, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:39:32.384293', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2164, 'pm1_0': 16, 'methanen': 400, 'Co': 9, 'gas': 184, 'DataTime': '2019-05-13 18:39:43.550772', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2165, 'pm1_0': 16, 'methanen': 398, 'Co': 9, 'gas': 182, 'DataTime': '2019-05-13 18:39:55.151071', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2166, 'pm1_0': 16, 'methanen': 380, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:40:06.209642', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2167, 'pm1_0': 16, 'methanen': 404, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:40:17.573581', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2168, 'pm1_0': 16, 'methanen': 415, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:40:28.774016', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2169, 'pm1_0': 16, 'methanen': 415, 'Co': 9, 'gas': 182, 'DataTime': '2019-05-13 18:40:40.074444', 'Humid': 35, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2170, 'pm1_0': 17, 'methanen': 413, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:40:51.364335', 'Humid': 35, 'Temp': 27, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2171, 'pm1_0': 17, 'methanen': 405, 'Co': 9, 'gas': 183, 'DataTime': '2019-05-13 18:41:02.674875', 'Humid': 35, 'Temp': 27, 'pm10': 20, 'GAS_leak': 'false'}, {'Number_of_samples': 2172, 'pm1_0': 15, 'methanen': 350, 'Co': 11, 'gas': 232, 'DataTime': '2019-05-14 00:11:15.294389', 'Humid': 35, 'Temp': 26, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2173, 'pm1_0': 15, 'methanen': 353, 'Co': 11, 'gas': 235, 'DataTime': '2019-05-14 00:11:26.585270', 'Humid': 38, 'Temp': 26, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2174, 'pm1_0': 16, 'methanen': 353, 'Co': 12, 'gas': 240, 'DataTime': '2019-05-14 00:11:37.894435', 'Humid': 37, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2175, 'pm1_0': 16, 'methanen': 352, 'Co': 12, 'gas': 241, 'DataTime': '2019-05-14 00:11:49.183752', 'Humid': 37, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2176, 'pm1_0': 16, 'methanen': 349, 'Co': 11, 'gas': 236, 'DataTime': '2019-05-14 00:12:00.484092', 'Humid': 37, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2177, 'pm1_0': 16, 'methanen': 351, 'Co': 11, 'gas': 232, 'DataTime': '2019-05-14 00:12:11.790337', 'Humid': 37, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2178, 'pm1_0': 16, 'methanen': 350, 'Co': 11, 'gas': 230, 'DataTime': '2019-05-14 00:12:23.078313', 'Humid': 37, 'Temp': 27, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2179, 'pm1_0': 16, 'methanen': 349, 'Co': 11, 'gas': 230, 'DataTime': '2019-05-14 00:12:37.154368', 'Humid': 39, 'Temp': 26, 'pm10': 19, 'GAS_leak': 'false'}, {'Number_of_samples': 2180, 'pm1_0': 16, 'methanen': 332, 'Co': 10, 'gas': 209, 'DataTime': '2019-05-14 00:42:46.679908', 'Humid': 35, 'Temp': 27, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2181, 'pm1_0': 15, 'methanen': 352, 'Co': 13, 'gas': 247, 'DataTime': '2019-05-14 01:12:55.219969', 'Humid': 35, 'Temp': 27, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2182, 'pm1_0': 15, 'methanen': 364, 'Co': 12, 'gas': 224, 'DataTime': '2019-05-14 01:43:06.846196', 'Humid': 36, 'Temp': 27, 'pm10': 18, 'GAS_leak': 'false'}, {'Number_of_samples': 2183, 'pm1_0': 21, 'methanen': 279, 'Co': 6, 'gas': 221, 'DataTime': '2019-05-14 03:31:46.702884', 'Humid': 37, 'Temp': 25, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 2184, 'pm1_0': 21, 'methanen': 222, 'Co': 6, 'gas': 126, 'DataTime': '2019-05-14 04:01:55.032802', 'Humid': 41, 'Temp': 24, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 2185, 'pm1_0': 19, 'methanen': 217, 'Co': 6, 'gas': 124, 'DataTime': '2019-05-14 04:32:03.410369', 'Humid': 41, 'Temp': 24, 'pm10': 24, 'GAS_leak': 'false'}, {'Number_of_samples': 2186, 'pm1_0': 20, 'methanen': 216, 'Co': 6, 'gas': 123, 'DataTime': '2019-05-14 05:02:11.780126', 'Humid': 41, 'Temp': 24, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 2187, 'pm1_0': 21, 'methanen': 217, 'Co': 6, 'gas': 123, 'DataTime': '2019-05-14 05:32:20.141168', 'Humid': 41, 'Temp': 24, 'pm10': 25, 'GAS_leak': 'false'}, {'Number_of_samples': 2188, 'pm1_0': 23, 'methanen': 216, 'Co': 6, 'gas': 128, 'DataTime': '2019-05-14 06:02:28.503868', 'Humid': 41, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2189, 'pm1_0': 24, 'methanen': 220, 'Co': 6, 'gas': 123, 'DataTime': '2019-05-14 06:32:36.867076', 'Humid': 41, 'Temp': 24, 'pm10': 29, 'GAS_leak': 'false'}, {'Number_of_samples': 2190, 'pm1_0': 24, 'methanen': 221, 'Co': 6, 'gas': 121, 'DataTime': '2019-05-14 07:02:45.228580', 'Humid': 42, 'Temp': 24, 'pm10': 28, 'GAS_leak': 'false'}, {'Number_of_samples': 2191, 'pm1_0': 26, 'methanen': 242, 'Co': 6, 'gas': 129, 'DataTime': '2019-05-14 07:32:53.599913', 'Humid': 44, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2192, 'pm1_0': 25, 'methanen': 268, 'Co': 6, 'gas': 147, 'DataTime': '2019-05-14 08:03:01.990399', 'Humid': 46, 'Temp': 24, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2193, 'pm1_0': 23, 'methanen': 278, 'Co': 6, 'gas': 159, 'DataTime': '2019-05-14 08:33:10.387271', 'Humid': 46, 'Temp': 24, 'pm10': 27, 'GAS_leak': 'false'}, {'Number_of_samples': 2194, 'pm1_0': 25, 'methanen': 269, 'Co': 6, 'gas': 146, 'DataTime': '2019-05-14 09:03:18.790678', 'Humid': 45, 'Temp': 24, 'pm10': 30, 'GAS_leak': 'false'}, {'Number_of_samples': 2195, 'pm1_0': 21, 'methanen': 279, 'Co': 6, 'gas': 146, 'DataTime': '2019-05-14 09:33:27.182760', 'Humid': 46, 'Temp': 24, 'pm10': 26, 'GAS_leak': 'false'}, {'Number_of_samples': 2196, 'pm1_0': 27, 'methanen': 252, 'Co': 6, 'gas': 141, 'DataTime': '2019-05-14 10:03:35.572659', 'Humid': 44, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2197, 'pm1_0': 26, 'methanen': 235, 'Co': 6, 'gas': 137, 'DataTime': '2019-05-14 10:33:43.958395', 'Humid': 43, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2198, 'pm1_0': 27, 'methanen': 219, 'Co': 6, 'gas': 135, 'DataTime': '2019-05-14 11:03:52.350231', 'Humid': 43, 'Temp': 24, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2199, 'pm1_0': 28, 'methanen': 234, 'Co': 6, 'gas': 138, 'DataTime': '2019-05-14 11:34:00.727753', 'Humid': 43, 'Temp': 25, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2200, 'pm1_0': 31, 'methanen': 274, 'Co': 10, 'gas': 139, 'DataTime': '2019-05-14 12:05:58.048834', 'Humid': 42, 'Temp': 25, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2201, 'pm1_0': 28, 'methanen': 342, 'Co': 18, 'gas': 214, 'DataTime': '2019-05-14 12:36:06.647637', 'Humid': 42, 'Temp': 25, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2202, 'pm1_0': 32, 'methanen': 347, 'Co': 18, 'gas': 196, 'DataTime': '2019-05-14 13:06:15.132638', 'Humid': 41, 'Temp': 25, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2203, 'pm1_0': 34, 'methanen': 337, 'Co': 19, 'gas': 204, 'DataTime': '2019-05-14 13:36:24.683785', 'Humid': 39, 'Temp': 25, 'pm10': 41, 'GAS_leak': 'false'}, {'Number_of_samples': 2204, 'pm1_0': 26, 'methanen': 318, 'Co': 20, 'gas': 208, 'DataTime': '2019-05-14 14:06:34.245488', 'Humid': 31, 'Temp': 25, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2205, 'pm1_0': 29, 'methanen': 314, 'Co': 21, 'gas': 208, 'DataTime': '2019-05-14 14:36:43.824916', 'Humid': 31, 'Temp': 25, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2206, 'pm1_0': 33, 'methanen': 322, 'Co': 21, 'gas': 208, 'DataTime': '2019-05-14 15:06:52.391656', 'Humid': 32, 'Temp': 25, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2207, 'pm1_0': 38, 'methanen': 319, 'Co': 21, 'gas': 211, 'DataTime': '2019-05-14 15:37:00.934668', 'Humid': 31, 'Temp': 25, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2208, 'pm1_0': 36, 'methanen': 328, 'Co': 21, 'gas': 213, 'DataTime': '2019-05-14 16:07:09.596023', 'Humid': 33, 'Temp': 25, 'pm10': 45, 'GAS_leak': 'false'}, {'Number_of_samples': 2209, 'pm1_0': 40, 'methanen': 323, 'Co': 21, 'gas': 213, 'DataTime': '2019-05-14 16:37:18.039162', 'Humid': 34, 'Temp': 26, 'pm10': 49, 'GAS_leak': 'false'}, {'Number_of_samples': 2210, 'pm1_0': 36, 'methanen': 332, 'Co': 21, 'gas': 217, 'DataTime': '2019-05-14 17:07:27.577506', 'Humid': 36, 'Temp': 26, 'pm10': 44, 'GAS_leak': 'false'}, {'Number_of_samples': 2211, 'pm1_0': 33, 'methanen': 313, 'Co': 20, 'gas': 211, 'DataTime': '2019-05-14 17:37:36.132544', 'Humid': 31, 'Temp': 25, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2212, 'pm1_0': 26, 'methanen': 320, 'Co': 20, 'gas': 211, 'DataTime': '2019-05-14 18:07:44.713675', 'Humid': 31, 'Temp': 25, 'pm10': 31, 'GAS_leak': 'false'}, {'Number_of_samples': 2213, 'pm1_0': 27, 'methanen': 320, 'Co': 21, 'gas': 211, 'DataTime': '2019-05-14 18:37:54.277086', 'Humid': 32, 'Temp': 25, 'pm10': 33, 'GAS_leak': 'false'}, {'Number_of_samples': 2214, 'pm1_0': 31, 'methanen': 315, 'Co': 22, 'gas': 211, 'DataTime': '2019-05-14 19:08:03.830281', 'Humid': 33, 'Temp': 25, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2215, 'pm1_0': 29, 'methanen': 333, 'Co': 21, 'gas': 215, 'DataTime': '2019-05-14 19:38:12.381859', 'Humid': 36, 'Temp': 25, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2216, 'pm1_0': 29, 'methanen': 331, 'Co': 21, 'gas': 207, 'DataTime': '2019-05-14 20:08:20.938073', 'Humid': 37, 'Temp': 24, 'pm10': 35, 'GAS_leak': 'false'}, {'Number_of_samples': 2217, 'pm1_0': 30, 'methanen': 330, 'Co': 22, 'gas': 206, 'DataTime': '2019-05-14 20:38:29.466538', 'Humid': 37, 'Temp': 25, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2218, 'pm1_0': 32, 'methanen': 337, 'Co': 24, 'gas': 213, 'DataTime': '2019-05-14 21:08:37.997277', 'Humid': 38, 'Temp': 25, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2219, 'pm1_0': 33, 'methanen': 333, 'Co': 22, 'gas': 220, 'DataTime': '2019-05-14 21:38:46.529155', 'Humid': 38, 'Temp': 25, 'pm10': 40, 'GAS_leak': 'false'}, {'Number_of_samples': 2220, 'pm1_0': 34, 'methanen': 331, 'Co': 22, 'gas': 219, 'DataTime': '2019-05-14 22:08:55.061832', 'Humid': 38, 'Temp': 24, 'pm10': 41, 'GAS_leak': 'false'}, {'Number_of_samples': 2221, 'pm1_0': 34, 'methanen': 330, 'Co': 22, 'gas': 219, 'DataTime': '2019-05-14 22:39:03.589092', 'Humid': 39, 'Temp': 24, 'pm10': 41, 'GAS_leak': 'false'}, {'Number_of_samples': 2222, 'pm1_0': 35, 'methanen': 338, 'Co': 22, 'gas': 221, 'DataTime': '2019-05-14 23:09:12.113688', 'Humid': 40, 'Temp': 24, 'pm10': 42, 'GAS_leak': 'false'}, {'Number_of_samples': 2223, 'pm1_0': 36, 'methanen': 339, 'Co': 21, 'gas': 224, 'DataTime': '2019-05-14 23:39:20.636913', 'Humid': 40, 'Temp': 24, 'pm10': 45, 'GAS_leak': 'false'}, {'Number_of_samples': 2224, 'pm1_0': 39, 'methanen': 337, 'Co': 17, 'gas': 252, 'DataTime': '2019-05-15 00:09:29.166273', 'Humid': 41, 'Temp': 24, 'pm10': 47, 'GAS_leak': 'false'}, {'Number_of_samples': 2225, 'pm1_0': 37, 'methanen': 339, 'Co': 17, 'gas': 256, 'DataTime': '2019-05-15 00:39:38.692331', 'Humid': 41, 'Temp': 24, 'pm10': 45, 'GAS_leak': 'false'}, {'Number_of_samples': 2226, 'pm1_0': 37, 'methanen': 338, 'Co': 19, 'gas': 255, 'DataTime': '2019-05-15 01:09:47.195392', 'Humid': 42, 'Temp': 24, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2227, 'pm1_0': 40, 'methanen': 357, 'Co': 19, 'gas': 259, 'DataTime': '2019-05-15 01:39:55.700687', 'Humid': 43, 'Temp': 24, 'pm10': 48, 'GAS_leak': 'false'}, {'Number_of_samples': 2228, 'pm1_0': 41, 'methanen': 379, 'Co': 19, 'gas': 261, 'DataTime': '2019-05-15 02:10:04.208153', 'Humid': 41, 'Temp': 24, 'pm10': 49, 'GAS_leak': 'false'}, {'Number_of_samples': 2229, 'pm1_0': 38, 'methanen': 373, 'Co': 19, 'gas': 259, 'DataTime': '2019-05-15 02:40:12.740442', 'Humid': 41, 'Temp': 24, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2230, 'pm1_0': 37, 'methanen': 378, 'Co': 18, 'gas': 261, 'DataTime': '2019-05-15 03:10:21.270573', 'Humid': 42, 'Temp': 25, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2231, 'pm1_0': 37, 'methanen': 385, 'Co': 18, 'gas': 267, 'DataTime': '2019-05-15 03:40:29.825987', 'Humid': 42, 'Temp': 25, 'pm10': 45, 'GAS_leak': 'false'}, {'Number_of_samples': 2232, 'pm1_0': 41, 'methanen': 357, 'Co': 22, 'gas': 246, 'DataTime': '2019-05-15 04:10:39.377028', 'Humid': 45, 'Temp': 24, 'pm10': 50, 'GAS_leak': 'false'}, {'Number_of_samples': 2233, 'pm1_0': 40, 'methanen': 335, 'Co': 22, 'gas': 215, 'DataTime': '2019-05-15 04:40:48.931792', 'Humid': 45, 'Temp': 24, 'pm10': 49, 'GAS_leak': 'false'}, {'Number_of_samples': 2234, 'pm1_0': 43, 'methanen': 344, 'Co': 24, 'gas': 231, 'DataTime': '2019-05-15 05:10:57.475726', 'Humid': 45, 'Temp': 24, 'pm10': 52, 'GAS_leak': 'false'}, {'Number_of_samples': 2235, 'pm1_0': 44, 'methanen': 350, 'Co': 25, 'gas': 232, 'DataTime': '2019-05-15 05:41:06.011294', 'Humid': 44, 'Temp': 24, 'pm10': 53, 'GAS_leak': 'false'}, {'Number_of_samples': 2236, 'pm1_0': 43, 'methanen': 359, 'Co': 26, 'gas': 239, 'DataTime': '2019-05-15 06:11:14.545312', 'Humid': 44, 'Temp': 24, 'pm10': 52, 'GAS_leak': 'false'}, {'Number_of_samples': 2237, 'pm1_0': 45, 'methanen': 360, 'Co': 27, 'gas': 248, 'DataTime': '2019-05-15 06:41:24.082982', 'Humid': 44, 'Temp': 24, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2238, 'pm1_0': 44, 'methanen': 374, 'Co': 27, 'gas': 254, 'DataTime': '2019-05-15 07:11:32.605649', 'Humid': 44, 'Temp': 24, 'pm10': 53, 'GAS_leak': 'false'}, {'Number_of_samples': 2239, 'pm1_0': 43, 'methanen': 383, 'Co': 27, 'gas': 257, 'DataTime': '2019-05-15 07:41:41.141595', 'Humid': 45, 'Temp': 24, 'pm10': 53, 'GAS_leak': 'false'}, {'Number_of_samples': 2240, 'pm1_0': 46, 'methanen': 382, 'Co': 27, 'gas': 259, 'DataTime': '2019-05-15 08:11:50.690830', 'Humid': 44, 'Temp': 24, 'pm10': 56, 'GAS_leak': 'false'}, {'Number_of_samples': 2241, 'pm1_0': 49, 'methanen': 381, 'Co': 27, 'gas': 259, 'DataTime': '2019-05-15 08:41:59.225977', 'Humid': 44, 'Temp': 24, 'pm10': 59, 'GAS_leak': 'false'}, {'Number_of_samples': 2242, 'pm1_0': 47, 'methanen': 388, 'Co': 27, 'gas': 265, 'DataTime': '2019-05-15 09:12:07.832431', 'Humid': 44, 'Temp': 24, 'pm10': 58, 'GAS_leak': 'false'}, {'Number_of_samples': 2243, 'pm1_0': 45, 'methanen': 395, 'Co': 27, 'gas': 268, 'DataTime': '2019-05-15 09:42:16.313045', 'Humid': 43, 'Temp': 24, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2244, 'pm1_0': 44, 'methanen': 392, 'Co': 25, 'gas': 269, 'DataTime': '2019-05-15 10:12:24.858132', 'Humid': 43, 'Temp': 24, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2245, 'pm1_0': 44, 'methanen': 395, 'Co': 25, 'gas': 271, 'DataTime': '2019-05-15 10:42:33.399929', 'Humid': 43, 'Temp': 25, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2246, 'pm1_0': 44, 'methanen': 399, 'Co': 25, 'gas': 271, 'DataTime': '2019-05-15 11:12:41.958042', 'Humid': 43, 'Temp': 25, 'pm10': 53, 'GAS_leak': 'false'}, {'Number_of_samples': 2247, 'pm1_0': 55, 'methanen': 325, 'Co': 11, 'gas': 139, 'DataTime': '2019-05-15 11:42:50.528973', 'Humid': 46, 'Temp': 25, 'pm10': 68, 'GAS_leak': 'false'}, {'Number_of_samples': 2248, 'pm1_0': 65, 'methanen': 327, 'Co': 12, 'gas': 132, 'DataTime': '2019-05-15 12:13:00.108966', 'Humid': 47, 'Temp': 25, 'pm10': 79, 'GAS_leak': 'false'}, {'Number_of_samples': 2249, 'pm1_0': 48, 'methanen': 317, 'Co': 12, 'gas': 130, 'DataTime': '2019-05-15 12:43:08.725825', 'Humid': 46, 'Temp': 25, 'pm10': 59, 'GAS_leak': 'false'}, {'Number_of_samples': 2250, 'pm1_0': 47, 'methanen': 315, 'Co': 13, 'gas': 128, 'DataTime': '2019-05-15 13:13:17.264385', 'Humid': 44, 'Temp': 25, 'pm10': 58, 'GAS_leak': 'false'}, {'Number_of_samples': 2251, 'pm1_0': 41, 'methanen': 307, 'Co': 13, 'gas': 127, 'DataTime': '2019-05-15 13:43:25.838418', 'Humid': 40, 'Temp': 25, 'pm10': 49, 'GAS_leak': 'false'}, {'Number_of_samples': 2252, 'pm1_0': 39, 'methanen': 291, 'Co': 12, 'gas': 124, 'DataTime': '2019-05-15 14:13:34.416405', 'Humid': 37, 'Temp': 25, 'pm10': 48, 'GAS_leak': 'false'}, {'Number_of_samples': 2253, 'pm1_0': 40, 'methanen': 301, 'Co': 12, 'gas': 126, 'DataTime': '2019-05-15 14:43:42.991946', 'Humid': 38, 'Temp': 25, 'pm10': 49, 'GAS_leak': 'false'}, {'Number_of_samples': 2254, 'pm1_0': 38, 'methanen': 351, 'Co': 13, 'gas': 185, 'DataTime': '2019-05-15 22:57:47.918146', 'Humid': 0, 'Temp': 0, 'pm10': 47, 'GAS_leak': 'false'}, {'Number_of_samples': 2255, 'pm1_0': 38, 'methanen': 370, 'Co': 12, 'gas': 228, 'DataTime': '2019-05-15 22:59:12.086759', 'Humid': 0, 'Temp': 0, 'pm10': 47, 'GAS_leak': 'false'}, {'Number_of_samples': 2256, 'pm1_0': 38, 'methanen': 359, 'Co': 13, 'gas': 209, 'DataTime': '2019-05-15 23:29:20.629520', 'Humid': 43, 'Temp': 27, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2257, 'pm1_0': 38, 'methanen': 355, 'Co': 15, 'gas': 222, 'DataTime': '2019-05-15 23:59:30.195639', 'Humid': 41, 'Temp': 27, 'pm10': 46, 'GAS_leak': 'false'}, {'Number_of_samples': 2258, 'pm1_0': 39, 'methanen': 338, 'Co': 12, 'gas': 191, 'DataTime': '2019-05-16 00:29:38.765246', 'Humid': 41, 'Temp': 27, 'pm10': 48, 'GAS_leak': 'false'}, {'Number_of_samples': 2259, 'pm1_0': 42, 'methanen': 282, 'Co': 12, 'gas': 195, 'DataTime': '2019-05-16 00:59:47.328502', 'Humid': 43, 'Temp': 26, 'pm10': 51, 'GAS_leak': 'false'}, {'Number_of_samples': 2260, 'pm1_0': 45, 'methanen': 340, 'Co': 13, 'gas': 222, 'DataTime': '2019-05-16 01:29:55.887833', 'Humid': 45, 'Temp': 26, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2261, 'pm1_0': 45, 'methanen': 301, 'Co': 14, 'gas': 192, 'DataTime': '2019-05-16 02:00:04.415399', 'Humid': 45, 'Temp': 26, 'pm10': 55, 'GAS_leak': 'false'}, {'Number_of_samples': 2262, 'pm1_0': 51, 'methanen': 301, 'Co': 14, 'gas': 201, 'DataTime': '2019-05-16 02:30:12.914901', 'Humid': 44, 'Temp': 25, 'pm10': 62, 'GAS_leak': 'false'}, {'Number_of_samples': 2263, 'pm1_0': 49, 'methanen': 303, 'Co': 14, 'gas': 205, 'DataTime': '2019-05-16 03:00:21.426336', 'Humid': 44, 'Temp': 26, 'pm10': 59, 'GAS_leak': 'false'}, {'Number_of_samples': 2264, 'pm1_0': 50, 'methanen': 302, 'Co': 12, 'gas': 190, 'DataTime': '2019-05-16 03:30:29.954627', 'Humid': 44, 'Temp': 26, 'pm10': 61, 'GAS_leak': 'false'}, {'Number_of_samples': 2265, 'pm1_0': 52, 'methanen': 291, 'Co': 12, 'gas': 194, 'DataTime': '2019-05-16 04:00:38.489959', 'Humid': 45, 'Temp': 26, 'pm10': 64, 'GAS_leak': 'false'}, {'Number_of_samples': 2266, 'pm1_0': 53, 'methanen': 307, 'Co': 13, 'gas': 208, 'DataTime': '2019-05-16 04:30:47.022486', 'Humid': 45, 'Temp': 26, 'pm10': 66, 'GAS_leak': 'false'}, {'Number_of_samples': 2267, 'pm1_0': 53, 'methanen': 308, 'Co': 13, 'gas': 204, 'DataTime': '2019-05-16 05:00:55.551235', 'Humid': 45, 'Temp': 26, 'pm10': 64, 'GAS_leak': 'false'}, {'Number_of_samples': 2268, 'pm1_0': 52, 'methanen': 307, 'Co': 13, 'gas': 200, 'DataTime': '2019-05-16 05:31:04.117615', 'Humid': 44, 'Temp': 25, 'pm10': 63, 'GAS_leak': 'false'}, {'Number_of_samples': 2269, 'pm1_0': 54, 'methanen': 304, 'Co': 13, 'gas': 206, 'DataTime': '2019-05-16 06:01:12.620893', 'Humid': 44, 'Temp': 25, 'pm10': 66, 'GAS_leak': 'false'}, {'Number_of_samples': 2270, 'pm1_0': 54, 'methanen': 305, 'Co': 12, 'gas': 201, 'DataTime': '2019-05-16 06:31:21.159203', 'Humid': 45, 'Temp': 25, 'pm10': 66, 'GAS_leak': 'false'}, {'Number_of_samples': 2271, 'pm1_0': 55, 'methanen': 309, 'Co': 14, 'gas': 200, 'DataTime': '2019-05-16 07:01:29.690127', 'Humid': 45, 'Temp': 25, 'pm10': 67, 'GAS_leak': 'false'}, {'Number_of_samples': 2272, 'pm1_0': 61, 'methanen': 317, 'Co': 15, 'gas': 195, 'DataTime': '2019-05-16 07:31:38.221196', 'Humid': 46, 'Temp': 25, 'pm10': 74, 'GAS_leak': 'false'}, {'Number_of_samples': 2273, 'pm1_0': 67, 'methanen': 316, 'Co': 15, 'gas': 194, 'DataTime': '2019-05-16 08:01:47.766678', 'Humid': 45, 'Temp': 25, 'pm10': 83, 'GAS_leak': 'false'}, {'Number_of_samples': 2274, 'pm1_0': 67, 'methanen': 322, 'Co': 15, 'gas': 195, 'DataTime': '2019-05-16 08:31:56.300378', 'Humid': 46, 'Temp': 25, 'pm10': 84, 'GAS_leak': 'false'}, {'Number_of_samples': 2275, 'pm1_0': 68, 'methanen': 329, 'Co': 15, 'gas': 195, 'DataTime': '2019-05-16 09:02:04.847182', 'Humid': 46, 'Temp': 25, 'pm10': 86, 'GAS_leak': 'false'}, {'Number_of_samples': 2276, 'pm1_0': 70, 'methanen': 332, 'Co': 15, 'gas': 197, 'DataTime': '2019-05-16 09:32:13.385734', 'Humid': 48, 'Temp': 26, 'pm10': 90, 'GAS_leak': 'false'}, {'Number_of_samples': 2277, 'pm1_0': 70, 'methanen': 325, 'Co': 15, 'gas': 212, 'DataTime': '2019-05-16 10:02:21.905433', 'Humid': 48, 'Temp': 26, 'pm10': 90, 'GAS_leak': 'false'}, {'Number_of_samples': 2278, 'pm1_0': 56, 'methanen': 310, 'Co': 15, 'gas': 219, 'DataTime': '2019-05-16 10:32:32.439777', 'Humid': 44, 'Temp': 27, 'pm10': 69, 'GAS_leak': 'false'}, {'Number_of_samples': 2279, 'pm1_0': 48, 'methanen': 301, 'Co': 13, 'gas': 226, 'DataTime': '2019-05-16 11:02:41.992803', 'Humid': 41, 'Temp': 26, 'pm10': 58, 'GAS_leak': 'false'}, {'Number_of_samples': 2280, 'pm1_0': 42, 'methanen': 269, 'Co': 9, 'gas': 170, 'DataTime': '2019-05-16 11:32:50.478122', 'Humid': 44, 'Temp': 26, 'pm10': 51, 'GAS_leak': 'false'}, {'Number_of_samples': 2281, 'pm1_0': 43, 'methanen': 325, 'Co': 10, 'gas': 194, 'DataTime': '2019-05-16 12:03:00.033917', 'Humid': 44, 'Temp': 26, 'pm10': 52, 'GAS_leak': 'false'}, {'Number_of_samples': 2282, 'pm1_0': 41, 'methanen': 340, 'Co': 12, 'gas': 207, 'DataTime': '2019-05-16 12:33:08.625478', 'Humid': 43, 'Temp': 26, 'pm10': 50, 'GAS_leak': 'false'}, {'Number_of_samples': 2283, 'pm1_0': 30, 'methanen': 304, 'Co': 10, 'gas': 188, 'DataTime': '2019-05-16 13:03:17.217833', 'Humid': 37, 'Temp': 26, 'pm10': 37, 'GAS_leak': 'false'}, {'Number_of_samples': 2284, 'pm1_0': 31, 'methanen': 292, 'Co': 10, 'gas': 196, 'DataTime': '2019-05-16 13:33:25.799677', 'Humid': 36, 'Temp': 26, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2285, 'pm1_0': 28, 'methanen': 291, 'Co': 10, 'gas': 183, 'DataTime': '2019-05-16 14:03:34.370857', 'Humid': 34, 'Temp': 26, 'pm10': 34, 'GAS_leak': 'false'}, {'Number_of_samples': 2286, 'pm1_0': 32, 'methanen': 286, 'Co': 10, 'gas': 201, 'DataTime': '2019-05-16 14:33:42.965052', 'Humid': 32, 'Temp': 27, 'pm10': 39, 'GAS_leak': 'false'}, {'Number_of_samples': 2287, 'pm1_0': 31, 'methanen': 293, 'Co': 10, 'gas': 171, 'DataTime': '2019-05-16 15:03:51.569002', 'Humid': 34, 'Temp': 27, 'pm10': 38, 'GAS_leak': 'false'}, {'Number_of_samples': 2288, 'pm1_0': 32, 'methanen': 295, 'Co': 10, 'gas': 172, 'DataTime': '2019-05-16 15:34:00.174509', 'Humid': 34, 'Temp': 27, 'pm10': 39, 'GAS_leak': 'false'}]";
                        } else {
                            dataInput = response.body();
                        }
                        dataInput = dataInput.replace("'", "\"");
                        final String finalText = dataInput;
                        try {
                            jsonArray = new JSONArray(finalText);
                        } catch (JSONException e) {
                            e.printStackTrace();
                        }
                        List<Map> ListMapL = new ArrayList<>();
                        for (int i = 0; i < jsonArray.length(); i++) {
                            Map<String, String> map = new HashMap<>();
                            Gson gson = new Gson();
                            try {
                                ListMapL.add(gson.fromJson(jsonArray.getString(i), map.getClass()));
                            } catch (JSONException e) {
                                e.printStackTrace();
                            }
                            Map<String, Float> discomfort = new HashMap<>();
                            float discomfortData = (9.0f / 5 * Float.parseFloat(ListMapL.get(i).get("Temp").toString())) - 0.55f * (1f - Float.parseFloat(ListMapL.get(i).get("Humid").toString()) / 100f) * (9.0f / 5.0f * Float.parseFloat(ListMapL.get(i).get("Temp").toString()) - 26.0f) + 32.0f;
                            discomfort.put("Discomfort", discomfortData);
                            ListMapL.get(i).putAll(discomfort);
                        }
                        Log.d("discomfort data", ListMapL.toString());
                        ((MainActivity) Objects.requireNonNull(getActivity())).ListMap = ListMapL;
                        int j, maxIndex = 0;
                        for (int i = 0; i < ListMapL.size() - 1; ) {
                            String data = ListMapL.get(i).get("DataTime").toString().substring(0, 11);
                            for (j = i; j < ListMapL.size() && data.equals(ListMapL.get(j).get("DataTime").toString().substring(0, 11)); j++) {
                            }
                            maxIndex++;
                            Log.d("index", maxIndex + " : " + data);
                            i = j;
                        }
                        dataInfo.setText("서버로부터 " + maxIndex + "일 간의 총 " + ListMapL.size() + "개의 데이터를 불러왔습니다.");
                    }

                    public void onFailure(Call<String> call, Throwable t) {
                        final Toast toast = Toast.makeText(activity, "서버와의 통신에 실패했습니다.", Toast.LENGTH_LONG);
                        toast.show();
                    }
                });
            }
        });
        Button bluetoothButton = view.findViewById(R.id.bluetoothButton);
        bluetoothButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                bluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
                if (bluetoothAdapter == null) {
                    MainActivity activity = (MainActivity) getActivity();
                    Toast.makeText(activity, "블루투스를 지원하지 않는 기기입니다.", Toast.LENGTH_LONG).show();
                } else {
                    if (bluetoothAdapter.isEnabled()) {
                        selectBluetoothDevice();
                    } else {
                        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
                        startActivityForResult(intent, REQUEST_ENABLE_BT);
                    }
                }
            }
        });
        return view;
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        switch (requestCode) {
            case REQUEST_ENABLE_BT:
                if (resultCode == RESULT_OK) {
                    selectBluetoothDevice();
                } else {
                    MainActivity activity = (MainActivity) getActivity();
                    Toast.makeText(activity, "블루투스 활성화가 필요합니다.", Toast.LENGTH_LONG).show();
                }
                break;
        }
    }

    public void selectBluetoothDevice() {
        devices = bluetoothAdapter.getBondedDevices();
        pairedDeviceCount = devices.size();
        if (pairedDeviceCount == 0) {
            MainActivity activity = (MainActivity) getActivity();
            Toast.makeText(activity, "설정에서 먼저 페어링을 진행해주세요.", Toast.LENGTH_LONG).show();
        } else {
            MainActivity activity = (MainActivity) getActivity();
            AlertDialog.Builder builder = new AlertDialog.Builder(activity);
            builder.setTitle("블루투스 기기를 선택해주세요");
            List<String> list = new ArrayList<>();
            for (BluetoothDevice bluetoothDevice : devices) {
                list.add(bluetoothDevice.getName());
            }
            final CharSequence[] charSequences = list.toArray(new CharSequence[list.size()]);
            list.toArray(new CharSequence[list.size()]);
            builder.setItems(charSequences, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    connectDevice(charSequences[which].toString());
                }
            });
            AlertDialog alertDialog = builder.create();
            alertDialog.show();
        }
    }

    public void connectDevice(String deviceName) {
        for (BluetoothDevice tempDevice : devices) {
            if (deviceName.equals(tempDevice.getName())) {
                bluetoothDevice = tempDevice;
                break;
            }
        }
        UUID uuid = java.util.UUID.fromString("00001101-0000-1000-8000-00805f9b34fb"); //Base UUID
        try {
            BluetoothSocket bluetoothSocket = bluetoothDevice.createRfcommSocketToServiceRecord(uuid);
            bluetoothSocket.connect();
            outputStream = bluetoothSocket.getOutputStream();
            inputStream = bluetoothSocket.getInputStream();
            MainActivity activity = (MainActivity) getActivity();
            Toast.makeText(activity, "연결에 성공했습니다.", Toast.LENGTH_SHORT).show();
            receiveData();

        } catch (IOException e) {
            MainActivity activity = (MainActivity) getActivity();
            Toast.makeText(activity, "연결에 실패했습니다.", Toast.LENGTH_LONG).show();
            e.printStackTrace();
        }
    }

    public void receiveData() {
        final Handler handler = new Handler();
        readBufferPosition = 0;
        readBuffer = new byte[10000];
        Thread workerThread = new Thread(new Runnable() {
            @Override
            public void run() {
                while (!(Thread.currentThread().isInterrupted())) {
                    try {
                        int byteAvailable = inputStream.available();
                        if (byteAvailable > 0) {
                            byte[] bytes = new byte[byteAvailable];
                            inputStream.read(bytes);
                            for (int i = 0; i < byteAvailable; i++) {
                                byte tempByte = bytes[i];
                                if (tempByte == ']') {
                                    byte[] encodedBytes = new byte[readBufferPosition];
                                    System.arraycopy(readBuffer, 0, encodedBytes, 0, encodedBytes.length);
                                    //final String text = new String(encodedBytes, "US-ASCII");
                                    String text = new String(encodedBytes, StandardCharsets.US_ASCII);
                                    text = text.replace("'", "\"");
                                    text += ']';
                                    Log.d("run data", text);
                                    readBufferPosition = 0;
                                    final String finalText = text;
                                    handler.post(new Runnable() {
                                        @SuppressLint("SetTextI18n")
                                        @Override
                                        public void run() {
                                            Log.d("run data", finalText);
                                            try {
                                                jsonArray = new JSONArray(finalText);
                                            } catch (JSONException e) {
                                                e.printStackTrace();
                                            }
                                            List<Map> ListMapL = new ArrayList<>();
                                            for (int i = 0; i < jsonArray.length(); i++) {
                                                Map<String, String> map = new HashMap<>();
                                                Gson gson = new Gson();
                                                try {
                                                    ListMapL.add(gson.fromJson(jsonArray.getString(i), map.getClass()));
                                                } catch (JSONException e) {
                                                    e.printStackTrace();
                                                }
                                                Map<String, Float> discomfort = new HashMap<>();
                                                float discomfortData = (9.0f / 5 * Float.parseFloat(ListMapL.get(i).get("Temp").toString())) - 0.55f * (1f - Float.parseFloat(ListMapL.get(i).get("Humid").toString()) / 100f) * (9.0f / 5.0f * Float.parseFloat(ListMapL.get(i).get("Temp").toString()) - 26.0f) + 32.0f;
                                                discomfort.put("Discomfort", discomfortData);
                                                ListMapL.get(i).putAll(discomfort);
                                            }
                                            Log.d("discomfort data", ListMapL.toString());
                                            ((MainActivity) Objects.requireNonNull(getActivity())).ListMap = ListMapL;
                                            int j, maxIndex = 0;
                                            for (int i = 0; i < ListMapL.size() - 1; ) {
                                                String data = ListMapL.get(i).get("DataTime").toString().substring(0, 11);
                                                for (j = i; j < ListMapL.size() && data.equals(ListMapL.get(j).get("DataTime").toString().substring(0, 11)); j++) {
                                                }
                                                maxIndex++;
                                                Log.d("index", maxIndex + " : " + data);
                                                i = j;
                                            }
                                            dataInfo.setText("블루투스 기기로부터 " + maxIndex + "일 간의 총 " + ListMapL.size() + "개의 데이터를 불러왔습니다.");
                                            MainActivity activity = (MainActivity) getActivity();
                                            Toast.makeText(activity, "데이터를 수신했습니다.", Toast.LENGTH_SHORT).show();
                                        }
                                    });
                                } else {
                                    readBuffer[readBufferPosition++] = tempByte;
                                }
                            }
                        }
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                    try {
                        Thread.sleep(1000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        });
        workerThread.start();
    }
}
